<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>README-etcdutl</title>
    <link rel="icon" href="https://sempernow.github.io/refpages/sa/favicon.png">
    <link rel="stylesheet" href="https://sempernow.github.io/refpages/sa/css/normalize.css">
    <link rel="stylesheet" href="https://sempernow.github.io/refpages/sa/css/main.css">
    <!--
    <link rel="stylesheet" href="https://sempernow.github.io/refpages/sa/css/dev.css">
    -->
    <link rel="stylesheet" href="https://sempernow.github.io/refpages/sa/css/hljs.github.min.css">
    <style>

    </style>
    <script src="https://sempernow.github.io/refpages/sa/js/hl.min.js"></script>
    <script>hljs.highlightAll()</script>
</head>
<body>
    <main>
        <h1>etcdutl</h1>

<p><code>etcdutl</code> is a command line administration utility for <a href="https://github.com/coreos/etcd">etcd</a>.</p>

<p>It's designed to operate directly on etcd data files.
For operations over a network, please use <code>etcdctl</code>.</p>

<h3>DEFRAG [options]</h3>

<p>DEFRAG directly defragments an etcd data directory while etcd is not running.
When an etcd member reclaims storage space from deleted and compacted keys, the space is kept in a free list and the database file remains the same size. By defragmenting the database, the etcd member releases this free space back to the file system.</p>

<p>In order to defrag a live etcd instances over the network, please use <code>etcdctl defrag</code> instead.</p>

<h4>Options</h4>

<ul>
<li>data-dir -- Optional. If present, defragments a data directory not in use by etcd.</li>
</ul>

<h4>Output</h4>

<p>Exit status '0' when the process was successful.</p>

<h4>Example</h4>

<p>To defragment a data directory directly, use the <code>--data-dir</code> flag:</p>

<pre><code class="language-bash"># Defragment while etcd is not running
./etcdutl defrag --data-dir default.etcd
# success (exit status 0)
# Error: cannot open database at default.etcd/member/snap/db
</code></pre>

<h4>Remarks</h4>

<p>DEFRAG returns a zero exit code only if it succeeded in defragmenting all given endpoints.</p>

<h3>SNAPSHOT RESTORE [options] &lt;filename&gt;</h3>

<p>SNAPSHOT RESTORE creates an etcd data directory for an etcd cluster member from a backend database snapshot and a new cluster configuration. Restoring the snapshot into each member for a new cluster configuration will initialize a new etcd cluster preloaded by the snapshot data.</p>

<h4>Options</h4>

<p>The snapshot restore options closely resemble to those used in the <code>etcd</code> command for defining a cluster.</p>

<ul>
<li><p>data-dir -- Path to the data directory. Uses &lt;name&gt;.etcd if none given.</p></li>

<li><p>wal-dir -- Path to the WAL directory. Uses data directory if none given.</p></li>

<li><p>initial-cluster -- The initial cluster configuration for the restored etcd cluster.</p></li>

<li><p>initial-cluster-token -- Initial cluster token for the restored etcd cluster.</p></li>

<li><p>initial-advertise-peer-urls -- List of peer URLs for the member being restored.</p></li>

<li><p>name -- Human-readable name for the etcd cluster member being restored.</p></li>

<li><p>skip-hash-check -- Ignore snapshot integrity hash value (required if copied from data directory)</p></li>
</ul>

<h4>Output</h4>

<p>A new etcd data directory initialized with the snapshot.</p>

<h4>Example</h4>

<p>Save a snapshot, restore into a new 3 node cluster, and start the cluster:</p>

<pre><code>./etcdutl snapshot save snapshot.db

# restore members
bin/etcdutl snapshot restore snapshot.db --initial-cluster-token etcd-cluster-1 --initial-advertise-peer-urls http://127.0.0.1:12380  --name sshot1 --initial-cluster 'sshot1=http://127.0.0.1:12380,sshot2=http://127.0.0.1:22380,sshot3=http://127.0.0.1:32380'
bin/etcdutl snapshot restore snapshot.db --initial-cluster-token etcd-cluster-1 --initial-advertise-peer-urls http://127.0.0.1:22380  --name sshot2 --initial-cluster 'sshot1=http://127.0.0.1:12380,sshot2=http://127.0.0.1:22380,sshot3=http://127.0.0.1:32380'
bin/etcdutl snapshot restore snapshot.db --initial-cluster-token etcd-cluster-1 --initial-advertise-peer-urls http://127.0.0.1:32380  --name sshot3 --initial-cluster 'sshot1=http://127.0.0.1:12380,sshot2=http://127.0.0.1:22380,sshot3=http://127.0.0.1:32380'

# launch members
bin/etcd --name sshot1 --listen-client-urls http://127.0.0.1:2379 --advertise-client-urls http://127.0.0.1:2379 --listen-peer-urls http://127.0.0.1:12380 &amp;
bin/etcd --name sshot2 --listen-client-urls http://127.0.0.1:22379 --advertise-client-urls http://127.0.0.1:22379 --listen-peer-urls http://127.0.0.1:22380 &amp;
bin/etcd --name sshot3 --listen-client-urls http://127.0.0.1:32379 --advertise-client-urls http://127.0.0.1:32379 --listen-peer-urls http://127.0.0.1:32380 &amp;
</code></pre>

<h3>SNAPSHOT STATUS &lt;filename&gt;</h3>

<p>SNAPSHOT STATUS lists information about a given backend database snapshot file.</p>

<h4>Output</h4>

<h5>Simple format</h5>

<p>Prints a humanized table of the database hash, revision, total keys, and size.</p>

<h5>JSON format</h5>

<p>Prints a line of JSON encoding the database hash, revision, total keys, and size.</p>

<h4>Examples</h4>

<pre><code class="language-bash">./etcdutl snapshot status file.db
# cf1550fb, 3, 3, 25 kB
</code></pre>

<pre><code class="language-bash">./etcdutl --write-out=json snapshot status file.db
# {&quot;hash&quot;:3474280699,&quot;revision&quot;:3,&quot;totalKey&quot;:3,&quot;totalSize&quot;:24576}
</code></pre>

<pre><code class="language-bash">./etcdutl --write-out=table snapshot status file.db
+----------+----------+------------+------------+
|   HASH   | REVISION | TOTAL KEYS | TOTAL SIZE |
+----------+----------+------------+------------+
| cf1550fb |        3 |          3 | 25 kB      |
+----------+----------+------------+------------+
</code></pre>

<h3>VERSION</h3>

<p>Prints the version of etcdutl.</p>

<h4>Output</h4>

<p>Prints etcd version and API version.</p>

<h4>Examples</h4>

<pre><code class="language-bash">./etcdutl version
# etcdutl version: 3.1.0-alpha.0+git
# API version: 3.1
</code></pre>

<h3>VERSION</h3>

<p>Prints the version of etcdctl.</p>

<h4>Output</h4>

<p>Prints etcd version and API version.</p>

<h4>Examples</h4>

<pre><code class="language-bash">./etcdutl version
# etcdutl version: 3.5.0
# API version: 3.1
</code></pre>

<h2>Exit codes</h2>

<p>For all commands, a successful execution returns a zero exit code. All failures will return non-zero exit codes.</p>

<h2>Output formats</h2>

<p>All commands accept an output format by setting <code>-w</code> or <code>--write-out</code>. All commands default to the &quot;simple&quot; output format, which is meant to be human-readable. The simple format is listed in each command's <code>Output</code> description since it is customized for each command. If a command has a corresponding RPC, it will respect all output formats.</p>

<p>If a command fails, returning a non-zero exit code, an error string will be written to standard error regardless of output format.</p>

<h3>Simple</h3>

<p>A format meant to be easy to parse and human-readable. Specific to each command.</p>

<h3>JSON</h3>

<p>The JSON encoding of the command's <a href="../api/etcdserverpb/rpc.proto">RPC response</a>. Since etcd's RPCs use byte strings, the JSON output will encode keys and values in base64.</p>

<p>Some commands without an RPC also support JSON; see the command's <code>Output</code> description.</p>

<h3>Protobuf</h3>

<p>The protobuf encoding of the command's <a href="../api/etcdserverpb/rpc.proto">RPC response</a>. If an RPC is streaming, the stream messages will be concatenated. If an RPC is not given for a command, the protobuf output is not defined.</p>

<h3>Fields</h3>

<p>An output format similar to JSON but meant to parse with coreutils. For an integer field named <code>Field</code>, it writes a line in the format <code>&quot;Field&quot; : %d</code> where <code>%d</code> is go's integer formatting. For byte array fields, it writes <code>&quot;Field&quot; : %q</code> where <code>%q</code> is go's quoted string formatting (e.g., <code>[]byte{'a', '\n'}</code> is written as <code>&quot;a\n&quot;</code>).</p>

<h2>Compatibility Support</h2>

<p>etcdutl is still in its early stage. We try out best to ensure fully compatible releases, however we might break compatibility to fix bugs or improve commands. If we intend to release a version of etcdutl with backward incompatibilities, we will provide notice prior to release and have instructions on how to upgrade.</p>

<h3>Input Compatibility</h3>

<p>Input includes the command name, its flags, and its arguments. We ensure backward compatibility of the input of normal commands in non-interactive mode.</p>

<h3>Output Compatibility</h3>

<p>Currently, we do not ensure backward compatibility of utility commands.</p>

<h3>TODO: compatibility with etcd server</h3>
 
    </main>

    <script src="https://sempernow.github.io/refpages/sa/js/base.js"></script>
    <script>
        ;(function(o, undefined){
            'use strict'
            window.addEventListener('load', () => {
                ;(() => {})//()
                ;(() => {})//()
                ;(() => { // FOO LAB
                    const log = o.log('foo')
                        ,main = o.css('MAIN')
                    log('foo')
                    o.toDOM(main, '<h1>TEST</h1>')
                })//()
            })
        })( (typeof window !== 'undefined') 
            && (window[__APP__] = window[__APP__] || {})
                || (typeof global !== 'undefined') 
                    && (global[__APP__] = global[__APP__] || {})
        );
    </script>
</body>
</html>
